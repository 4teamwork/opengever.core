
Changelog
=========

4.9.0 (unreleased)
------------------

- Enables to replace a checked out document by Drag'n'Drop.
  [phgross]

- Redirect to meeting tab when a meeting has been created.
  [deiferni]

- Decouple default values for fields from any forms (as much as possible).
  This is necessary groundwork for later changes that will make sure that
  default values also get set during programmatic content creation.
  [lgraf]

- Refactor opengever.tabbedview:

  - Provide better base classes for tabs
  - Expose base classes in opengever.tabbedview instead of a submodule
  - Provide support for state filters in all tabs with minimal effort
  - remove duplicate/dead code
  - drop unused clients-listing

  [deiferni]

- Log CSRF incidents to Sentry (if possible).
  [lgraf]

- Add committee model workflow, to allow de- or reactivating a committee.
  [phgross]

- Bumblebee: Implement gallery preview image fallback.
  [Kevin Bieri]

- Update Bumblebee integration for API v3 support.
  [phgross]

- Add batching for the bumblebee gallery-view.
  [elioschmutz]

- Fix tests for GeverJSONSummarySerializer: The `member` attribute
  has been renamed to `items` in plone/plone.restapi#107.
  [lgraf]

- Add 'open as pdf' link in the bumblebee overlay.
  [elioschmutz]

- Add Visual Search (Bumblebee) integration using ftw.bumblebee.

  This new feature can be toggled with a feature flag.
  We introduces two new dependencies, ftw.bumblebee to provide the base
  integration and for communicating with the bumblebee service and
  ftw.showroom display the overlay.

  The initial integration also adds the following UI components:

  - A gallery with small preview-thumbnails for documents of a dossier
  - A large preview thumbnail on the document overview
  - Small preview-thumbnails for search-results
  - An overlay to read the document that opens when clicking on
    one of the aforementioned thumbnails and a document in a document
    listing (tab)

  [elioschmutz, Kevin Bieri, deiferni]

- Fix sample protocol template control structures.
  [deiferni]


4.8.1 (2016-05-03)
------------------

- Update trix to 0.9.6
  [Kevin Bieri]


4.8.0 (2016-05-02)
------------------

- Only show active sub-dossiers in dossier navigation.
  [deiferni]

- Clean up our monkey patches.
  [lgraf]

- Fix bug in redirect when no templatedossier is found.
  [phgross]

- Create and update proposals and documents with elevated privileges,
  when submitting proposal, add or update submitted documents or
  copy back excerpt documents.
  [phgross]

- Exclude email from sablon variable fullname and add a email variable instead.
  Note: The sablontemplates have to be updated after installing this release,
  when the email is still needed in the protocoll.
  [phgross]

- Enable zip-export for personal overview.
  [deiferni]

- Reworked XLSReporter using the openpyxl library instead of xlwt, to support
  xlsx creation.
  [phgross]

- TranslatedTitleBrain: Also use Missing.Value as indicator that a brain
  has no translated title, and should therefore return the regular title.
  [lgraf]

- Make default value for IDossier.start a defaultFactory instead
  of a form level default.
  [lgraf]

- REST API: Customize summary representation to include

  - Translated 'title' for objects with ITranslatedTitleSupport
  - The object's portal_type

 [lgraf]

- Meeting: Rename button to create paragraphs to "insert".
  [deiferni]

- Fix an issue with importing no_client_id_grouped_by_three formatted
  repositories.
  [deiferni]

- Fix wrong from/to column labels in meeting overviews.
  [deiferni]

- Meeting Protocol:

  - Also provide the role for the meetings presidency and secretary in the JSON data.
  - Add presidency and secretary role to the example protocol sablon template.
  - Harmonize format of all participants (members, presidency, secretary).

  Note: The Sablontemplates have to be updated after installing this release!
  [phgross]

- Language Tool: Enable request content negotiation.
  [lgraf]

- Fixes sitetitle for wrapper objects.
  [phgross]

- No longer attempt to parse temporary excel files while creating repositories.
  [deiferni]

- Redirect to the members listingtab after adding a new member instead of the members detailview.
  [phgross]

- Various updates to API documentation.
  [lgraf]

- Remove unused fallback method for TranslatedTitleBrain (it has never worked so far).
  [elioschmutz]

- Fix broken TranslatedTitleBrain. It has to return utf-8 instead of unicode.
  [elioschmutz]

- Only groups where the user is a member are available to select when creating/editing committees.
  [elioschmutz]

- Fix examplecontent repositories.
  [deiferni]


4.7.4 (2016-03-23)
------------------

- No longer set start-page for documents generated as protocol excerpts.
  [deiferni]


4.7.3 (2016-03-17)
------------------

- Optimize `user_is_allowed_to_view()`.
  [buchi]

- meeting: Allow blank end date for meetings
  [Kevin Bieri]

- Show email addresses of participant in a meeting or a meeting protocol.
  [elioschmutz]

- Add API documentation (Sphinx).
  [lgraf]


4.7.2 (2016-03-10)
------------------

- Keep existing date on a protocol instead of creating a new one.
  [Kevin Bieri]

- Fix timezone mess in datetimepicker.
  [Kevin Bieri]


4.7.1 (2016-03-10)
------------------

- Implement sorter for 'no_client_id_grouped_by_three' reference number formatter.
  [lgraf]

- Activate "remove GEVER content" by default for new policies.
  [deiferni]


4.7.0 (2016-03-07)
------------------

- Add no_client_id_grouped_by_three reference number formatter.
  [deiferni]

- Make sure IRedirector JS redirects aren't unconditionally trigged when the
  user is on the @@confirm-action view.
  [lgraf]

- Meeting: Implement hint for conflicts while saving a protocol.
  [Kevin Bieri]

- Improve agenda-item workflow, allow decided agenda-items to be re-opened for
  revision. Also update excerpts when the agenda-item is revised.
  [phgross, deiferni]

- Add a fix for links from Microsoft Office applications.
  The fix hacks around office's behavior to resolve links prior to opening
  a browser. This lead to an "insufficient privileges" page being displayed if
  the user was already logged in. The fix attempts to traverse to the came_from
  url that is available to the require_login script, and if the url is traversable
  redirects to that location.
  [deiferni]

- Update locking message for locked protocols.
  [elioschmutz]

- Add a link to update an outdated document from the proposal view.
  [elioschmutz]

- Prevent creating a mail-copy in the dossier when sending documents
  from a closed dossiers.
  [elioschmutz]

- Add a custom handler to force a page reload (and thus force a
  redirect to the login form) when tabbed-view requests are redirected to
  the gever portal.
  [deiferni]

- Fix an issue where tabs on the plone site were visible as anonymous under
  certain circumstances.
  [deiferni]

- Add trix customizations to prevent accepting unsupported content.
  We don't support links, quotes, code-blocks and file uploads of any kind.
  [deiferni]

- Avoid infinite loops in find_parent_dossier() and set_default_with_acquisition()
  if context is not acquisition wrapped.
  [lgraf]

- Add an editable title to meeting objects.
  The user can set the title for a meeting manually now. Per default,
  the title will be the name of the committee and the date.
  [elioschmutz]

- Disable editing of decided agenda-items in protocol view.
  [elioschmutz]

- Avoid infinite loop in BasicReferenceNumber.get_parent_numbers() if context
  is not acquisition wrapped.
  [lgraf]

- Fixes an issue with broken db-migrations.
  Don't load proposal model in upgrade steps but use sqlalchemy expression
  api for database access.
  [deiferni]

- Activate notification-center by default.
  [elioschmutz]

- Add link in meetingoverview from unscheduled proposals to their corresponding submitted proposals.
  [elioschmutz]

- Introduce [api] extra that pulls in plone.restapi (and plone.rest).
  [lgraf]

- Change title and filename for generated excerpts.
  Old title format: Protocolexcerpt-[meetingtitle, meetingdate]
  New title format: [excerpttitle] - [meetingtitle, meetingdate].
  [elioschmutz]

- Add skip_defaults_fields for CreateGeneratedDocumentCommand.
  Fix the issue, where the object-title was always the document-title.
  [elioschmutz]

- Add link from submitted proposal to dossier if it's in the same admin-unit.
  [elioschmutz]

- Setup upgrade-step directories for all default profiles. [jone]

- Add link from proposal to meeting.
  [elioschmutz]

- Add attributes for proposal view.

  - publish_in
  - disclose_to
  - copy_for_attention

  Add additional attributes for submitted proposal view:

  - considerations
  - discussion

  [elioschmutz]

- Add link from proposal to committee.
  [elioschmutz]

- Adjust french translation 'En modification' to eCH-0039-standard 'En cours de traitement'
  [elioschmutz]

- Adjust proposaloverview view.
  Moves the document listing into the attributes-table, to gain more
  space for the table.
  [elioschmutz]

- Adjust proposal tabbedview tab.

  - Remove unused rows: 'initial_position' and 'proposed_action'
  - Add referencenumber row
  - Add meeting row: link to the related meeting if the proposal is scheduled

  [elioschmutz]

- Make a proposal's repository-folder title available as variable
  for sablon templates.
  [deiferni]

- Use autoselect for proposals add and edit view.
  [Kevin Bieri]

- Add upgrade-step to update feedback link in footer (if necessary).
  [lgraf]

- Prevent saving the protocol when it is locked by another user.
  [deiferni]

- Rename "Kommission" to more generic "Gremium"
  [elioschmutz]

- Display versions tab for sablon templates.
  [deiferni]

- Translate "Standort" to "Sitzungsort" for Meetings.
  [elioschmutz]

- Change translation for label_publish_in
  [elioschmutz]

- Update policy templates: Creates meeting portlet if enable_meeting_feature
  is true.
  [elioschmutz]

- Recycle reference numbers. When moving an object back to a previous
  parent, the previous reference number is recycled.
  [jone]

- Remove "reference_number" from catalog metadata.
  [jone]

- Prevent that the protocol form can overwrite a newer version of the protocol.
  If concurrent modifications occur we don't offer conflict resolution as of yet but
  leave the submitted form open to allow the user to take manual action.
  [deiferni]


4.6.3 (2016-01-25)
------------------

- Reduce complexity for traversing the scrollspy navigation tree.
  [Kevin Bieri]

- Add migration for trix, convert fields from markdown to html.
  [deiferni]

- Exclude non visible fields from the scrollspy navigation.
  [Kevin Bieri]

- Introduce IDuringSetup marker interface to flag a request that
  happens during GEVER setup.
  [lgraf]

- Refactor sequence number generation in order to reduce conflicts
  in content creation requests and to ensure uniqueness.
  [jone]

- Update link to feedback forum in example content and policy template footers.
  [lgraf]

- Update policy templates to include casauth plugin.
  [elioschmutz]

- Use searchable dropdown widget for adding a membership
  [Kevin Bieri]

- Display an additional column for the meeting state in the meeting overview.
  [Kevin Bieri]

- Displays hint that no documents have been generated yet.
  [Kevin Bieri]

- Update policy templates to include default committee container and initial templates.
  [deiferni]

- Transform trix input to safe_html to prevent XSS vulerability.
  Implemented for protocol page and trix widgets.
  [deiferni]

- Introduce request method on controller to pass a validator for ajax requests.
  Only show notify messages when the response does not contain a redirect statement.
  [Kevin Bieri]

- Update LDAP path in policy templates.
  [deiferni]

- meeting: Use trix as editor in proposals.
  [Kevin Bieri, deiferni]

- meeting: Use trix as editor in protocol.
  [Kevin Bieri]

- Fix opengever.meeting upgrade to 4600 for MySQL. Delete a foreign key before
  its corresponding column is removed.
  [deiferni]

- Don't create savepoints in 46xx upgrade steps - MySQL implicitly commits
  savepoints as soon as a DDL statement is emitted (similar to Oracle).
  That means we can't reliably use savepoints in upgrade paths that contain
  upgrades involving DDL.
  [lgraf]

- Remove modified_seconds index and refactor tree portlet to use default
  modified index.
  [jone]

- ZEM download: Include filename of doc in metadata by
  registering a callback for Products.ExternalEditor that
  adds the filename to the metadata during ZEM generation.
  [lgraf]

- Refactor registration of additional mimetypes.
  [lgraf]

- Change CMFEdition IDs to uuid4 instead of auto-increment.
  This reduces conflict errors.
  [jone]


4.6.2 (2015-12-22)
------------------

- Add french translation for "My portal" action.
  [lgraf]

- Show hint for unsaved local changes while editing the protocol.
  [Kevin Bieri]

- Don't use current date when editing meeting participants but the meeting's date.
  [deiferni]

- Fix an encoding issue while editing memberships.
  [deiferni]

- Show diffrent buttons for deleting or unscheduling agenda items
  [Kevin Bieri]

- Make sure that decision numbers are available when rendering excerpts.
  [deiferni]

- Don't generate decision numbers for paragraphs.
  [deiferni]

- Fixed missing `responsible` parameters in synced responses when reassigning a multi AdminUnit task.
  [phgross]

- Cluster URL: Add heuristic to determine the correct cluster base URL
  for both single- and multi-admin-unit setups.
  [lgraf]

- Make `my-portal` action use @@gever_state/gever_portal_url
  [lgraf]

- Add a `gever_state` view with traversable helper methods for use in TAL
  expressions and templates.
  [lgraf]

- Introduce the concept of a GEVER portal URL.
  [lgraf]

- Introduce the concept of a base URL for the GEVER cluster.
  [lgraf]

- Only build URL to CAS server once during setup, after that fetch it
  from the plugin when used as a base to build other URLs.
  [lgraf]


4.6.1 (2015-12-16)
------------------

- Use bootstrap datetimepicker for selecting date and time for meetings.
  [Kevin Bieri]

- Include ftw.profilehook, when required.
  [deiferni]

- Fix an issue with setting-up translated content with transmogrifiers schemaupdater.
  [deiferni]

- Fix an issue with repo-folders not stored persistently on committee after create.
  [deiferni]


4.6.0 (2015-12-11)
------------------

multilingual support
~~~~~~~~~~~~~~~~~~~~

- Added support for bilingual titles in the repositorysystem and the main elements.
  [phgross]


opengever.meeting
~~~~~~~~~~~~~~~~~

- Add periods to committees. A period represents a timespan similar to a fiscal year.

    - Display the current period on committee overview.
    - Add a wizard to close the current and create its successor.
    - Add a wizard that creates an initial period upon committee creation.
    - Each meeting is assigned a meeting number when the meeting is closed. The meeting number
      is unique per period and committee.
    - Each agenda-item is assigned a decision number when its meeting is closed. The decision
      number is unique per period and committee.

  [deiferni]

- Link committees to a repository folder and link meetings to meeting-dossiers:

    - Add a new content-type, meeting-dossier.
    - Link dossier and meeting creation, automatically create a meeting-dossier
      when a meeting is created.
    - Automatically generate Protocols into the meeting's dossier.
    - Use dossier title as default title for new proposals.

  [deiferni]

- Refactor and improve planning and holding meetings:

    - Implement clientside processing for meeting view (Controller Pattern).
    - Display date in metadata section.
    - Set all active members of a committee as meeting participants by default.
    - Add an option to decide a single agenda_item.
    - Make sure protocol exists and is updated when closing a meeting.
    - Add confirm-dialog when closing meetings.
    - Simplify meeting workflow, drop state `held`.
    - Add protocol start-page setting to meetings and include this configuration
      in JSON for documents generated by sablon.
    - Include missing items in protocol navigation.
    - Extend agenda items in protocol view with numbers.
    - Remove pre-protocols, they are now the same as protocols.
    - Remove edit restrictions, let meetings be editable until they are closed.
    - Also display a members role in a meeting's protocol.
    - Add locking support for meetings.
    - Lock protocol documents while a meeting is not closed.
    - Save dossier's reference number on proposal and display it on protocol
      form and protocol word.

  [Kevin Bieri, phgross, deiferni]

- Add permissons for meetings.

    - Add 'add Member' permission.
    - Add permissions to Committee and CommitteeContainer workflows.
    - Protect views with correct permissions instead of just View.
    - Add configurable group to committees and set local roles on a committee for that group.
    - Cleanup owner from rolemap.xml.
    - Add own role for commitee-group-members.

  [deiferni]

- Make meeting datetime columns timezone aware.
  The following columns are affected:

    - Meeting.start
    - Meeting.end
    - ProposalHistory.created

  [deiferni]

- Allow rejecting proposals from a committee. It is possible to enter an optional comment.
  [deiferni]

- No longer allow adding content to proposals.
  Add excerpt to proposal's dossier instead.
  [deiferni]

- Link meeting from meeting-dossier overview.
  [deiferni]

- Fix member edit link and refactor generating breadcrumbs for models.
  [deiferni]

- Introduce wrapper objects for members and memberships to eliminate
  traversal hacks.
  [deiferni]

- No longer show wrapper objects in pathbar.
  [deiferni]

- Fixed get_parent_dossier getter for document inside a proposal.
  [phgross]

- Remove expired locks before creating new locks to avoid integrity-errors
  during database flushes.
  [deiferni]

- Introduce a wrapper object for meetings and use it as context. So the
  traversal-hack on every meeting view can be eliminated.
  [phgross]

- Add additional columns publish_in, disclose_to and copy_for_attention
  to proposals, protocols and protocol excerpts.
  [deiferni]

- Also provide information to sablon templates whether an agenda item
  is a paragraph.
  [deiferni]

- Add a view to fill sablon-templates with sample meeting-data.
  [deiferni]


CSRF
~~~~

- Include plone4.csrffixes in order to get back on the "Plone Way" to use
  automatic CSRF protection with Plone 4. This allows use to drop some of
  our custom handling of certain cases:

    - Transforming responses with uncommon charsets
    - Our own way of marking objects for safe writes
    - Unprotecting writes to _dav_writelocks
    - Handling context portlet assignments

  [lgraf]


opengever.activity
~~~~~~~~~~~~~~~~~~

- Make sure only the new responsible gets notified by mail, when a
  task gets reassigned.
  [phgross]


miscellaneous
~~~~~~~~~~~~~

- Adjust footer links (Release-Informationen, Quellcode).
  [phgross]

- Disallow access to views on the portal root for anonymous except of login
  form and password reset.
  [buchi]

- Move plone-group creation in OrgUnitBuilder to opengever.core.
  [deiferni]

- Remove leftover related_items catalog metadata.
  [deiferni]

- Merge changes made on `minimal` repository configuration to the `municipality` one.
  [phgross]

- Let OGMail inherit from ftw.mail.mail.Mail.
  [deiferni]

- Add submodule opengever.locking which add locking support for sqlobjects.
  [phgross]

- Prevent a silently ignored key error in our PAS IAuthenticationPlugin
  for internal requests.
  [lgraf]

- No longer create RelationValue manually, this is now done by ftw.builder.
  [deiferni]


4.5.8 (2015-11-25)
------------------

- Fixes activity upgradestep for mysql. Drop foreign key first before droping
  the column when using mysql as OGDS backend.
  [phgross]

- Extend whitelist for anonymous access on siteroot.
  [lgraf, phgross]

- ResponseTransporter: fix de- and encoding of deadline changes.
  [phgross]

- Make sure reassign a task over the edit form creates a response and record an activity.
  [phgross]

- Eliminate duplicate notification, about a task acceptance, when creating a successor.
  [phgross]


4.5.7 (2015-11-03)
------------------

- Disallow access to views on the portal root for anonymous except of login
  form and password reset.
  [buchi]

- Make sure only the new responsible gets notified by mail, when a
  task gets reassigned.
  [phgross]

- Revert review_state checks when accepting or assigning a task/forwarding.
  [phgross]

- Fixed issue in Tasks `by_container` query, with similar dossier-ids.
  [phgross]

- Notification viewlet: Fix javascript for sites with disabled activity feature.
  [phgross]

- Rework notification viewlet:

    - Reimplement viewlet functionality clientside
    - Display all notifications and add endless scrolling
    - Mark notifications as read when opening the dropdown.

  [phgross]

- Notification center: Register actor as watcher instead of every single user.
  [phgross]

- Notifications: Store subscription role, on each resource <-> watcher relation.
  Do allow a fine-grained configuration for the dispatchers.
  [phgross]

- VersionsTab: Use getHistoryMetadata() instead of getHistory() to avoid
  fetching the actual versioned objects and hence improve performance.
  [lgraf]

- Extend logging of task SQL synchronisation, with tasks modification date.
  [phgross]


4.5.6 (2015-09-17)
------------------

- CSRF: unprotect initializing annotations and sequence numbers.
  [deiferni]

- Fixed bug in retention_period:
  The RetentionPeriodValidator respect the is_restricted flag now.
  [phgross]


4.5.5 (2015-09-15)
------------------

- Add NullResponseDescription fallback for responses without a transition.
  This makes the use of the ResponseDescriptions (ResponseViewlet etc.) more robust.
  [phgross]

- Fix duplicate activity recordings when a forwarding gets reassigned.
  [phgross]

- Fix Upgrade-Step that updates lexicon: The affected indexes need to be
  cleared first before rebuilding them, otherwise the lexicon might not get
  updated properly.
  [lgraf]

- Add logging to the task SQL synchronisation.
  [phgross]

- Also log object oids in csrf logs.
  [deiferni]

- Use supertabular* to render multi-page tables instead of longtable to
  fix an issue with tables breaking pages too late.
  [deiferni]

- Hide foreign part of predecessor/successor pairs in the opentaskreport listings.
  [phgross]

- Validate task title length.
  [deiferni]


4.5.4 (2015-09-08)
------------------

- No longer allow reverting document versions while documents are checked out.
  [deiferni]

- CSRF: Add view to enable and disable CSRF tracing monkey patches.
  [lgraf]

- Add debug view to trigger a plone.protect confirmation dialog.
  [lgraf]


4.5.3 (2015-09-01)
------------------

- Add detailed logging for CSRF incidents.
  [lgraf]

- Fix missing journal entry due to CSRF when downloading copy or
  pdf-preview of a document from document overview.
  [deiferni]


4.5.2 (2015-08-27)
------------------

- Disable csrf protection for CreateSuccesorForwardingView.
  [phgross]

- Make mail upgradesteps (to4500, to4501) more defensive.
  [phgross]

- ReferenceNumberPrefixAdpater: Fix conditions for lazily initialising
  PersistentMappings in annotations.
  [lgraf]


4.5.1 (2015-08-19)
------------------

- Notification mail: hide "display" label for activities without a description.
  [phgross]

- Make sure to create an RFC2047 compliant From: or To: header when sending mails.
  (By avoiding encoded-words in angle-addr or addr-spec).
  [lgraf

- Fix layout and styling in notification mail also for microsoft outlook.
  [phgross]

- Drop limitation of notifications and make notification viewlet scrollable instead.
  [phgross]

- Notification viewlet: added tooltip to the "mark as read" link.
  [phgross]

- Notification viewlet: sort notification chronologic, newest at the top.
  [phgross]

- My Notification: disable sorting for type, title and actor column.
  [phgross]

- Fixed order in dossiers factory menu.
  [phgross]

- No longer use plone's text/x-html-safe for simple markup fragments, use
  escape_html instead.
  No longer inherit from DisplayForm in task-overview, use grok.View instead.
  [deiferni]

- Fixed lookup for active TaskTemplateFolders.
  [phgross]

- Display my notification tab also for regular users.
  [phgross]

- Don't show paste action for closed dossiers.
  [deiferni]

- MyNotifications: Make `resolve_notification_link` not mix unicode and str
  in string formatting by explicitly decoding the URL from ascii.
  [lgraf]

- Use `UnicodeCoercingText` type for all previous `Text` columns.
  This makes sure we always get `unicode` back from Text columns,
  whether the backend is Oracle, PostgreSQL or MySQL.
  Depends on opengever.ogds.models >= 2.3.1.
  [lgraf]

- Use an admin-unit's public url to generate urls to resolve notifications.
  [deiferni]

- Reintroduce a monkey patch for NamedDataConverter.toFieldValue after
  pinning down plone.formwidget.namedfile back to 1.0.7. The patch ensures
  hat mime-types sent by the browser are ignored.
  [deiferni]

- Fix ftw.mail.inbound.createMailInContainer monkey patch so it
  sets message.contentType to unicode, not str (see ftw.mail#33).
  [lgraf]

- Improve notification center's error_handling.
  Catch exception during dispatching a notification separately.
  [phgross]

- No longer generate reference numbers for templatedossiers.
  Also Cleanup old generated reference numbers.
  [deiferni]

- No longer display an empty tab 'additional' on the forwarding edit page.
  [deiferni]

- Fix an issue with the open taks report action, make sure it displayed again.
  [deiferni]

- Disable inline validation.
  [phgross]

- Use correct geometry setup for landscape pdfs.
  [deiferni]

- Dossier WF: Allow 'Copy or Move' for Dossiers in closed states:
  This is necessary to be able to copy documents from closed dossiers.
  [lgraf]

- Fixed translation of PDF Preview button in document's tooltip.
  [phgross]

- Made Document's tooltip edit_direct link CSRF safe, adding the authentication token.
  [phgross]

- Fixed gever customization of sharing view, for updateSharingInfo.
  [phgross]

- Tasktemplate form: Redirects back to dossier and show statusmessage
  if no active tasktemplatefolders are registered.
  [phgross]

- Advanced search: Fix translation for filing no help text.
  [lgraf]

- Only show pending states on dossier overview.
  [deiferni]


4.5.0 (2015-08-03)
------------------

- Add CreatorMigrator that migrates creators for Dexterity objects.
  (to be used with ftw.usermigration).
  [lgraf]

- Added activity support for tasktemplates.
  [phgross]

- Use datetime formatter to display deadline label.
  [deiferni]

- Add upgrade-step to fix 'document_author' and 'title' for mails with
  incorrectly decoded header values.
  [lgraf]

- Move submitted with proposals list to its own document overview
  table row.
  [deiferni]

- Add authentication token also to the file and pdf version download link.
  [phgross]

- Prefix actor link with an icon in the participants listing.
  [phgross]

- Fix missing mail icon in mail edit view/properties view.
  [deiferni]

- Show context mimetype icon in custom no_download namedfile widget
  mode templates.
  [deiferni]

- Documents Tab: Make sure link text in "containing subdossier" column
  is HTML escaped.
  [lgraf]

- Documents Tab: Make sure document_author is HTML escaped.
  [lgraf]

- Added upgradestep wich cleanup no longer existing interfaces from the zc.relation
  catalog's interfaces_flattened mapping, to avoid pickling erros (see #1091).
  [phgross]

- Adapt SchemaMigration.is_oracle() check so it also recognizes the
  'oracle+cx_oracle' dialect.
  [lgraf]

- Make sure we always get unicode from SQLAlchemy for columns values by
  setting the `coerce_to_unicode` parameter for the cx_Oracle dialect.
  Necessary for SQLAlchemy >= 0.9.2
  See http://docs.sqlalchemy.org/en/latest/dialects/oracle.html#unicode)
  [lgraf]

- OGDS Updater: Fix some unicode errors while logging.
  [lgraf]

- Delay expensive plone upgrade that installs plone lexicon using I18N
  Case normalizer.
  [deiferni]

- Fix activity upgrade steps, don't rely on potentially dangerous imports
  from model but duplicate necessary information.
  [deiferni]

- Make `author_cache_key` also discriminate on hostname.
  This is required because this cache key is used to cache generated
  URLs, which are dependent on the hostname that is used to access the
  system (might be localhost + SSH tunnel).
  [lgraf]

- Only display link to proposal for documents in repositories.
  [deiferni]

- Show statusmessage after successfully submitting a proposal.
  [phgross]

- Autosizing textareas in the add and edit form of proposals.
  [phgross]

- OGDS Sync: Clear memberships from groups_users association table before
  importing them, so that memberships from groups that have been deleted in
  LDAP get removed from OGDS. Also deactivate groups that have been removed
  from LDAP (includes upgrade-step for new `active` column on `Group` model
  in og.ogds.models).
  [lgraf]

- Drop `ogds_log_file` product config option and instead log
  to a file with a fixed path in var/log/ogds-update.log, and
  make sure that file is rotated.
  [lgraf]

- Add `PathFinder` helper class to provide various Zope2 Instance
  related paths that are otherwise cumbersone to access.
  [lgraf]

- Make sure to always set OGDS sync logger to INFO level.
  Previously this was only guaranteed if product-config entry
  for the `ogds_log_file` was present in zope.conf.
  [lgraf]

- Drop unused opengever.ogds.base.sections.
  (Legacy transmogrifier-based OGDS synchronization).
  [lgraf]

- Update reference number of contained objects when referencenumber prefix changes.
  [phgross]

- Improve content and styling of the notification mail.
  [phgross]

- OGDSUpdater: Enforce uniqueness of user and group IDs on application side.
  [lgraf]

- Add internationalization support to the activity model.

  - Implement translatable activity columns with the help of SQLAlchemy i18n.
  - Added new attribute label to the Activity Model.
  - Correclty translate the tasktype in activity description.

  [phgross]

- Adjust document_date handling:

  - Update document_date to current date during checkin
  - Update document_date to version's creation_date when reverting to a version.

  [phgross]

- Make sure OGDS sync doesn't fail on user- or group IDs that are too long.
  Simply skip them and log a warning.
  [lgraf]

- Implement a versions tab for documents.
  (Superseeds the previously used history viewlet)
  [lgraf]

- Fixed path limitation of the catalog query in save_reference_number_prefix subscriber.
  [phgross]

- Fix invalid variable name in policy template.
  (Reference to setup.setup....)
  [lgraf]

- Improve the representation of the searchresults and the searchform.
  [phgross]

- Add debug helpers to assist in debugging plone.protect issues.
  [lgraf]

- Improve exception handling.
  Remove bare excepts and only catch Exception when possible. Also make sure to
  always re-raise ConflictError.
  [deiferni]

- Add support for extracting nested mails.
  Also refactor extraction of attachments from mails.
  [deiferni]

- Fix an issue with journal entries when deleting attachments from mails.
  [deiferni]

- Fixed ComponentLookupError in CancelDocument view, when mails are selected,
  show error statusmessage instead.
  [phgross]

- Show public_trial edit-form link also for documents inside tasks.
  [phgross]

- Set mail filename from title when creating/updating mails.
  The mail filename is now always set automatically as a normalized form of title.
  [deiferni]

- Set focus on first form field.
  [phgross]

- Add additional reference box in the dossier overview.
  [phgross]

- No longer overwrite mail metadata when it is already set.
  [deiferni]

- Fixed message type (warning) when resubmitting an already submitted document.
  [phgross]

- Optimize error handling of the NotificationCenter, show statusmessage
  instead of abort request.
  [phgross]

- Sort available templates alphabetically when creating a document from template.
  [deiferni]

- No longer link templates on the view that creates documents from templates.
  [deiferni]

- Use checkbox widget to select addable dossier types on a repository folder.
  [deiferni]

- Display a link to the containing subdossier on a dossier's document tab.
  [deiferni]

- Bump plone.formwidget.namedfile and remove corresponding monkeypatch in order
  to get changes from https://github.com/plone/plone.formwidget.namedfile/pull/9
  [lgraf]

- Add macro enabled office mimetypes to MTR.
  [lgraf]

- Update versions of opengever.core dependencies.
  [lgraf]

- TransitionControllers: Rebuild special handling for administrators,
  move agency check for administrators to each transition guard.
  [phgross]

- Add regression test for task type translations.
  [lgraf]

- Activity: Prevent generating duplicated activities when:

  - Reassigning tasks
  - Adding subtasks (Plone action-menu)
  - Delegating tasks (Workflow)
  - Modifying a deadline

  [deiferni]

- Migrate activity schema, use text for summary column.
  [deiferni]

- Prevent that tasks/forwardings can be accepted/assigned twice.
  This problem occurred with tasks/forwardings distributed over two (or more) admin-units.
  [deiferni]

- Allow deadline modification also for issuing_org_unit agency members.
  [phgross]

- Monkey patch http_server.compute_timezone_for_log in order to fix
  DST bug in timezone calculation for Z2 logs.
  [lgraf]

- No longer display emtpy tab 'additional' on forwarding add page.
  [deiferni]

- Fix MeetingListing: default sort_index, disalbe sorting for time columns.
  [phgross]

- Include collective.usernamelogger in core dependencies.
  [lgraf]

- Make task default deadline timedelta configurable per installation.
  [phgross]

- Remove unused copy-related-documents-to-inbox view.
  [deiferni]

- Task overview: Hide responsible info in subtask, maintask, successor and predecessor
  listing.
  [phgross]

- Update to Plone 4.3.2 and Dexterity 2.x.

  - Update imports for Plone 4.3.x compatibility.
  - Include dexterity extra requires (grok, relations).
  - Upate or rework views and javascript for Plone 4.3.x compatibility.
  - Fix CSRF protection exception for context annotations.
  - Replace test.cfg with 4.3 cfg.
  - Add plone.app.dexterity behavior IBasic to contactfolder.
  - Cleanup collective.js.jqueryui javascripts in registry, because upgradestep does not work correctly.
  - Cleanup no longer existing css files in css_registry.
  - Don't use grok-style template dir conventions for non grok templates.
  - Remove DexterityContent.__getattr__ monkey patch, this was a backport
    from Dexterity 2.x and has now been addressed with the upgrade to DX 2.
    (Includes regression test)

  [lgraf, phgross]


4.4.2 (2015-07-08)
------------------

- Fixed UnicodeEncodeError in state_label getter of tasks.
  [phgross]

- Fix Inbox Overview: Fix error while rendering overview. Also refactor
  boxes for inbox/dossier overview, introduce generic macro and mixin, remove inheritance.
  [deiferni]


4.4.1 (2015-06-09)
------------------

- CSRF: Allow _dav_writelocks to be initialized on context.
  [lgraf]

- Also assign navigation portlet to 'kontakte' in example content.
  Change navigation toplevel to 1. Also include hooks to setup navigation in policy template.
  [deiferni]

- Made reverting files to version link CSRF safe, adding the authentication token.
  [phgross]

- Only display the org-unit selector when multiple org-units are available.
  [deiferni]

- No longer use reserved names as column names. Also make sure this does not happen
  again in the future.
  [deiferni]

- Fix a typo in an opengever.activity models column name.
  [deiferni]

- Use short language codes "DE" and "FR" in language selector.
  [deiferni]

- Display a nested dossier-navigation on the dossier overview page. Display the navigation
  starting at the current dossier's root dossier. Don't display the navigation when no
  subdossiers are available.
  [deiferni]


4.4.0 (2015-06-01)
------------------

- SqlTableSource: Wrap `sort_on` with a ColumnClause when extending
  query with ordering in order to allow SQLAlchemy to properly
  quote column identifiers depending on the dialect (see #957).
  [lgraf]

- Meeting SchemaMigrations: Made some upgrades Oracle compatible.
  [phgross]

- Unify definition of of auto-incrementing SQL columns.
  Add explicit Sequence to enable of auto-increment for oracle. Also make
  server-side tables/sequences consistent with other model definitions for
  Postgres.
  [deiferni]

- Drop Owner from the workflows of the following content-types: document, contact, dossier,
  templatedossier, forwarding, inbox, mail, repository, repositoryroot, task.
  [deiferni]

- Fixed ResponseDescription when adding mails to a task.
  [phgross]

- Reworked object copy and paste functionality.

  - Made paste action CSRF safe.
  - Use default id format for copied objects.
  - Don't journalize automatically renamed objects during copy & paste process.
  - Replaced existing plone clipboard functionality with our own implementation.
  - Also prefix copied mails with "copy of" (same as documents).

  [phgross]

- Fixed activity timestamps(created) storing/using timezone aware datetime's.
  [phgross]

- Disable copy action in task listings.
  [phgross]

- Enable doc-properties for examplecontent and add example template file with doc-properties.
  [deiferni]

- Disable CSRF protection for remote requests.
  [phgross]

- Made dispatchers configurable per installation.
  [phgross]

- Migrate templatedossiers classes from Container to custom DossierContainer subclass.
  [deiferni]

- Restrict allowed dossier meeting content in ConstrainTypesDecider.
  [deiferni]

- Add initial policy template support and a simple SAAS policy template.
  [deiferni]

- Made featureflags (activity, meeting) more robust.
  [phgross]

- Fixed sql task synchronisation when task gets moved.
  [phgross]

- Redirect to documents tab instead of trash tab, after trashing documents.
  [phgross]

- Disallow deactivating a dossier which contains not closed tasks.
  [phgross]

- Implement scrollspy.
  [Kevin Bieri]

- Re-designed protocol view.
  [Kevin Bieri]

- Fixed wrongly displayed document_actions in task overview.
  [phgross]

- Fix upgrades for PostgreSQL/MySQL:

  - Fix opengever.policy.base upgrades, limit created tables to installed package.
  - Add idempotent MySQL implementations for creating/dropping indices and dropping tables.
  - Drop unnecessary/broken statements from migrations.
  - Drop a temporary table after the migration is finished.

  [deiferni]

- Fixed userdetails icons for group listings.
  [phgross]

- Also manage meeting permissions in dossier workflows.
  [deiferni]

- Re-designed meeting view.
  [Kevin Bieri]

- NotificationViewlet: Display message when no unread notifications exist.
  [phgross]

- Move MyNotifications listing to the PersonalOverview.
  [phgross]

- Notifications: added some missing translations.
  [phgross]

- Fix displaying agenda-item numbers. Make number optional and don't
  display it when no number is set (i.e. for paragraphs).
  [deiferni]

- Initalize annotations during object creation, to avoid CSRF messages on
  first object access.
  [phgross]

- Move empty template profiles from setup to examplecontent. Create reusable
  Municipality content profile with initial meeting content.
  [phgross, deiferni]

- Include ftw.footer and add content for the examplecontent profile.
  [phgross]

- Display submitted-to proposals (and document version) on document overview.
  Include a link that allows updating outdated documents.
  [deiferni]

- Add form to manually generate custom excerpts and store them in a dossier.
  [deiferni]

- Add markdown support to sablon files, update dependecies to most recent sablon release.
  [deiferni]

- Remove outdated gever styles (moved to plonetheme.teamraum).
  [Kevin Bieri]

- CSRF: Also allow writes to context portlet assignments.
  [lgraf]

- CSRF: Detect redirect loops on @@confirm-action view and
  break them if necessary.
  [lgraf]

- CSRF: Rollback transaction on @@confirm-action view to avoid
  creating redirect loops.
  [lgraf]

- Expanded/Collapsed triangle style for helptext-trigger.
  [Kevin Bieri]

- Add and update french and german translations.
  [phgross]

- Treeportlet: extend caching parameters with current language code.
  [phgross]

- Implement meeting closing:

  - Added automatic generation of excerpts for every scheduled proposal.
  - Copy back the excerpt to the original proposal.
  - Create Proposalhistory entry when decided.
  - Add excerpt box to the ProposalOverview.
  - Update proposal states during closing a meeting.
  - Show decision in ProposalOverview.
  - Made Proposal's Agendaitem backref a One-To-One relation.

  [phgross]

- Made MeetingTransition's CSRF safe.
  [phgross]

- Made documents and mails addable in proposals.
  [phgross]

- Activate statefilter also in subdossiers listings.
  [phgross]

- Fixed french translations
  [phgross]

- Add sablon-template tab on template dossiers.
  [deiferni]

- No longer show sablon templates in navigation.
  [deiferni]

- Fix downloading protocol-previews in safari.
  [deiferni]

- Fix downloading sablong templates in template dossier.
  [deiferni]

- Optimize member and membership view:

  - Added Membership listing to MemberView.
  - Added Edit functionality for Memberships.
  - Added Remove functionality for Memberships.
  - Order Memberships on date_from date by default.
  - Add memberhip_id column to membership table.

  [phgross]

- Extend meeting type views with corresponding watermark icon.
  [phgross]

- Extend meeting type links with corresponding icon.
  [phgross]

- Make sablon templates configurable on commitee-container. The following
  templates are available: Pre-protocol, protocol and excerpt.
  [deiferni]

- Made different SchemaMigration Upgradesteps more robust.
  [phgross]

- Customize CSRF confirmation page and add German translations.
  [lgraf]

- Added translations for the SearchBoxViewlet placeholder.
  [phgross]

- CSRF: always allow object annotations to be written.
  [jone, deiferni]

- Fix icons for the treeporlet favorite functionality.
  [phgross]

- Made DeactivatedFKConstraint compatible with newer alembic versions.
  [phgross]

- Fix submitting proposals that reference mails.
  [deiferni]

- Meeting: add editing protocols, creating/downloading/updating protocol documents.
  [deiferni]

- Examplecontent profile: Add french to the supported language.
  [phgross]

- Customize LanguageSelector viewlet to display it as a menu.
  [phgross]

- Fixed actor for all task activities.
  [phgross]

- Add initial notification support:

  - Added NotificationCenter including SQL representations for activitities, notifications, resource and watchers.
  - Added a feature flag to disable/enable notifications
  - Added notification viewlet which contains a badge icon and lists unread notifications
  - Added notifications overview with a MyNotification tab
  - Add mail notification dispatcher.

  [phgross]

- Implement migrating participants in DossierMigrator.
  [lgraf]

- Add DictstorageMigrator that migrates user IDs in dictstorage keys (in SQL).
  (to be used with ftw.usermigration).
  [lgraf]

- Add OGDSMigrator that migrates users and inbox groups in OGDS SQL tables
  (to be used with ftw.usermigration).
  [lgraf]

- Do not show resolved tasks as overdue.
  [phgross]

- Add DossierMigrator that migrates dossier responsibles (to be used
  with ftw.usermigration).
  [lgraf]

- Meeting: disable navigation portlet for commitee-container when installing
  example profile.
  [deiferni]

- Meeting: only allow documents in dossiers to be submitted as additional documents.
  [deiferni]

- Meeting: add missing translations for meeting/membership add menu.
  [deiferni]

- Meeting: add missing translations for submitting additional documents.
  [deiferni]

- Meeting: don't allow overlapping committee-memberships.
  [deiferni]

- Meeting: allow editing initial position in pre-protocol.
  [deiferni]

- Meeting: integrate sablon document template processor for Word:
    - Integrate subprocess calls to sablon
    - Add pre-protocol download
    - Add pre-protocol document generation in dossiers
    - Add pre-protocol document updates for documents in dossiers

  [deiferni]

- Refactor document creation: reduce code duplication by extracting class
  to create documents and set default values properly.
  [deiferni]

- Meeting: add legal basis field to proposals, submitted proposals and
  pre-protocols.
  [deiferni]

- Refactor: add command to create documents. Use this command for
  quickupload-adapter, when creating-documents from template and when extracting
  documents from emails.
  [deiferni]

- Drop all SQL-tables during dev-setup, not only those defined in metadata.
  [deiferni]


4.3.0 (2015-03-20)
------------------

- Automatic CSRF protection with plone.protect 3.
  [jone]


4.2.1 (2015-03-17)
------------------

- SchemaMigration: Use IdempotentOperations only when executing migrations for MySQL.
  Also make sure that IdempotentOperations always keeps database metadata up to date.
  [deiferni]

- Upgrade: fix meeting upgrade to 4200, also migrate data, not only schema.
  [deiferni]

- Upgrade: add oracle/postgres implementation for upgrade to 4203.
  [deiferni]

- Upgrade: fix meeting upgrade to 4214, use sqlalchemy expression api as table definition
  instead of metadata.
  [deiferni]

- Upgrade: fix meeting upgrate to 4208, correctly create unique constraints.

- Fix an issue with event handlers while deleting a plone-site.
  [deiferni]

- Update translation for forwarding-transition-reassign transition.
  [phgross]

- Disable Remove GEVER content for inactive or resolved dossiers.
  [phgross]

- SchemaMigration: Make sure transaction is marked as changed even if it
  only contains DDL statements. See zope/sqlalchemy/README.txt#L145-L164
  [lgraf]

- SchemaMigration: Fix tracking table creation for DBs supporting transactional DDL:

  If the tracking table is created for the first time, it's not visible in
  metadata until the transaction has been committed.

  Therefore we need to have a method that tries to fetch an existing tracking
  table and return it, or if it doesn't exist yet, creates it and then
  returns the created table. In order to keep a reference to the tracking table
  across several SchemaMigration upgrade steps, a module global is used.

  Returning the table created by op.create_table requires alembic >= 0.7.0.
  [lgraf]

- Rename UniqueConstraints names of the SubmittedDocument table,
  because of oracle's limitation to 30 chars.
  [phgross]

- Drop three date/time fields in favour of two datetime fields.
  [deiferni, phgross]


4.2.0 (2015-03-12)
------------------

- Fixed date_of_completion display in task overview.
  [phgross]

- Use checkbox widget to select participations roles.
  This fixes an issue with ie10 and ie11 where no selection could be made.
  [deiferni]

- Keep predecessor's issuing_org_unit for successor tasks.
  [phgross]

- Replaced committees listing tab with a committes overview listing.
  [phgross]

- Switch to PostgreSQL for local development.
  [lgraf]

- Only assign 'Remove GEVER content' permission to manager by default.
  [lgraf]

- Protect 'remove_confirmation' view with 'Remove GEVER content' permission.
  [lgraf]

- Rewrite Redirector adapter to use cookies instead of sessions.
  Accessing sessions causes the transaction to be a write.
  [jone]

- Added committee overview tab.
  [phgross]

- Fixed `only_active` membership query.
  [phgross]

- Style protocol view in opengever.meeting.
  Implement sticky headings and autosize textareas.
  [Kevin Bieri]

- Meeting listing improvements:
    - Disable selection links for listings without checkbox column.
    - Extend proposal listing columns.
    - Fixed sorting and filtering for proposal and submittedproposal listings.
    - Fixed sorting and filtering for comitteecontainer tabs.
    - Fixed sorting and filtering for committee tabs.

- Task workflow: Make workflow also manage add permissions for mails,
  the same way it does for documents. In particular, this avoids mails
  being addable in tasks in state 'tested-and-closed'.
  [lgraf]

- Livesearch: Dropped unused icon <img> tag.
  [phgross]

- Style meeting form.
  Add agendaitem sorting implementation.
  [deiferni, Kevin Bieri]

- Wrap checks in is_pasting_allowed in a try..except for safety.
  [lgraf]

- Make sure response descriptions are always unicode.
  [lgraf]

- Add ftw.testbrowser widget for our customized AutocompleteWidget.
  [lgraf]

- Only show "Paste" action if objects in clipboard are in allowed addable
  types of target container.
  [lgraf]

- XlsSource: Handle values that are already a valid term for vocabulary fields.
  [lgraf]

- XlsSource: Raise KeyError if a value can't be found in the translation mapping
  for fields with a vocabulary, instead of just setting the translated value anyway.
  [lgraf]

- XlsSource: Add some more alternate spellings for archival_value mapping.
  [lgraf]

- Move items: handle twice submitted forms or invalid selected paths.
  [phgross]

- Fix and rework dossier deactivation and activation.
  [phgross]

- Add initial meeting support.
    - Add Proposal content type (proxies) and model.
    - Add feature flag, disable meeting feature by default.
    - Add Committee content type (proxy) and model.
    - Add custom forms to create/edit proxy-supported entities.
    - Add custom workflow implementation (no plone workflow).
    - Add a context manager to temporarily change the security context.
    - Add meeting model and forms.
    - Add schedule meeting action to committee.
    - Add scheduling of proposals as agenda items.
    - Add better committee page displaying meetings and submitted proposals.
    - Add custom content-views viewlet to display correct edit links for models.
    - Add custom pathbar viewlet which can display sql-models.
    - Add paragraph and custom text agenda items.
    - Make agenda items deletable.
    - Add a form to create a pre-protocols for meetings.
    - Disable edit-bar for model add-forms.
    - Add forms for Members and their Memberships in Committees.
    - Add tab to committees listing all memberships.
    - Add cancel buttons and form labels.
    - Add tabs to committee container for committees and members.
    - Allow submission of additional documents to already submitted proposals.
    - Log proposal history and display changes on the proposal overview.

  [deiferni]

- Dossier workflow: Also allow Administrator role to activate deactivated
  dossiers.
  [lgraf]

- OrgUnitSelector: Fix fallback logic:

  Build intersection of current admin units' org units and
  user's org units. If some of the user's org units are in the
  current admin unit, use the first of those as the fallback.

  Otherwise we're in an inter-admin unit operation, default to
  current admin unit's first org unit.
  [lgraf]

- CookieStorage: Extend max age of cookies to 30 days (was
  "end of browser session" before).
  [lgraf]

- OrgUnitSelector: Store selected OrgUnit after determining fallback.
  [lgraf]

- Rewrite advancedsearch to fix an issue with invalid requests to the search view.
  It is now allowed to filter by min or max value instead of just by date ranges
  (min and max) when querying for dates.
  [deiferni]

- Fix an issue with username/contacts-name based sorting in tabbedviews.
  [deiferni]

- Update german translations for opengever.meeting.
  [phabegger]


4.1.0 (2014-12-18)
------------------

- Made the AddPublicTrialColumn more robust.
  [phgross]

- Dropped no longer used document state journalization.
  [phgross]

- Disable docproperty updating in YearfolderStorer process.
  [phgross]

- Improved repository deletion (it's now possible without folder_contents view):
    - Revoke list folder contents permission on repository.
    - Add repository delete action and confirmation view.
    - Adjust global role mapping for delete objects permission.
    - Adjust delete objects permission for repositories.
    - Revoke delete objects permission for dossiers.
    - Added monkeypatch for _verifyObjectPaste to allow moving content without
      delete objects permission.

  [phgross]

- Implements content removal functionality for documentish objects:
    - Add new permission `Remove GEVER content`.
    - Added new document workflow state `document-state-removed`.
    - Added new mail workflow state `mail-state-removed`.
    - Add new action `Remove` to trash tab and add remove confirmation view.
    - Added journalization for document removing and restoring.

  [phgross]

- Rewrite gever setup.
    - Introduce two zcml directives to configure deployments and ldap profiles.
    - Simplify deloyment form, remove multi-client configuration options.
    - Update branding, add onegovgever logo.
    - Add custom setuphandlers for local roles, initial repository and document templates.
    - Configure development options and add environment variable to enable them easily.

  [deiferni]

- Disable nested inboxes.
  [deiferni]


4.0.6 (2014-12-09)
------------------

- Implement pessimistic connection invalidation (MySQL only):
  Check every connection that has been checked out from pool, and
  invalidate it if it's stale.
  [lgraf]

- Reworked OrgUnit Selector:
    - Store current unit to regular cookie instead of using the session_data_manager.
    - Differentiate between users_units (selectable) and admin_unit's org_unit
      (current org_unit).
    - Change current org_unit functionality, the current orgunit has to be
      part of the current admin_unit.

  [phgross]

- Made schemamigrations to 4.0.x release oracle compatible.
  [phgross]

- Fixed transporting task with the OGDS Transporter beetwen different admin_units.
  [phgross]


4.0.5 (2014-11-25)
------------------

- Extract attachments view: Fixed contenttype helper when lookup via filename.
  [phgross]


4.0.4 (2014-11-13)
------------------

- Extract attachments view: fixed icon display in attachment listing.
  [phgross]

- Disable paste action for mails.
  [phgross]

- Set proper Content-Type header in responses from LDAP control panel views.
  [lgraf]

- Fix Unicode handling in OGDSUpdater.
  [lgraf]

4.0.3 (2014-11-10)
------------------

- Dossier responsible field: use current admin unit's user, instead of only
  current orgunit's one.
  [phgross]

- Forwarding Transitioncontroller: Fixed assign_to_dossier check.
  [phgross]

- Add new type Inbox Container.
  [phgross]

- Task byline: Use adminUnit abbreviation instead of label for sequence_number display.
  [phgross]


4.0.2 (2014-11-03)
------------------

- Fixed version download, when download confirmation is deactivated.
  [phgross]

- Fixed UnicodeEncodeError in task link generation.
  [phgross]


4.0.1 (2014-10-27)
------------------

- Harmonize column lengths of groupid and userid columns.
  [phgross]


4.0.0 (2014-10-26)
------------------

- Changes to OGDS [phgross, deiferni]:

  - Replace `ContactInformation` utility with a service implemetation, available as `ogds_service`.
  - Update to latest `opengever.ogds.models` version.

  - Fixed encoding issues in the `EmailContactsAndUsersVocabularyFactory`.


- Replace Clients with OrgUnit/AdminUnit [phgross, deiferni]:

  - Remove one-to-one relationships of `PloneSite` and `Client` by introducting `AdminUnit` and `OrgUnit`.
  - An `AdminUnit` corresponds to one `PloneSite`.
  - An `AdminUnit` has a one-to-many relationship to `OrgUnit`.
  - Add utility functions to access the current `OrgUnit` and `AdminUnit`.
  - Add org-unit selector to switch between the user`s assigned org-units.
  - The oguid now consists of admin-unit-id and IntId.
  - Admin_unit intern `remote_requests` uses now unrestricted traversing.
  - Above changes concern the following functionality:

    - Sharing View
    - OGDS-Vocabularies
    - Default of task `responsible_client`
    - Cross plone-site request authentication
    - Cross plone-site wizards
    - PloneSite referencenumberpart is the admin_unit's abbreviation.


- Setup [phgross, deiferni]:

  - Make sure that inflator content-creation runs after gever setup.
  - Test that we correctly override ftw.inflator setuphandler configuration.
  - Create admin units and org units from generic setup profile.


- Inbox/Forwarding [phgross, deiferni]:

  - Use globalindex as data-source for task-listings (Overview, AssignedTasks, IssuedTasks).
  - Fix forwarding immediate view, use `issued_inbox_tasks` tab.
  - Assign forwarding to dossier: reset issuer to current inbox.
  - Accept task, edit in new dossier: Set default dossier title only for tasks but not for forwardings.
  - Inbox now ontains multiple Inboxes, one for each `OrgUnit`:

    - Allow nested inboxes.
    - Map inboxes and Orgunits with `ResponsibleOrgUnit` behavior.
    - Add redirecting to current subinbox.
    - Allow multiple yearfolders per inbox, one for each `OrgUnit`.

  - Disable statefilter for yearfolder's `ClosedForwardings` listing.
  - Rework `InboxTransitionController` guards.


- Tasks [phgross, deiferni]:

  - Refactor syncing tasks from plone to globalindex.
  - Use globalindex as data-source for task-listings (PersonalOverview).
  - Globalindex:

    - Introduce a specific query class for `Task`.
    - Make some task fields required.
    - Add containing_subdossier column.
    - Migrate data for issuing_org_unit.
    - Use integer sequence numbers.

  - Refactored display of task responses:

    - Include response descriptions.
    - Add permission-check for edit and delete actions.
    - Add response entry for task creation.

  - Add action menu viewlet:

    - Display transitions as buttons.
    - Display agency actions in a separate dropdown.

  - Drop old no longer used CopyDocumentsToRemoteClient functionality.
  - Enable Drag'n'drop upload for tasks.
  - Rework Task-Transition controller guards.
  - Replace modify-deadline and delegate actions with a task transition.
  - Display icon on task overview when task is overdue.
  - Add task-type to searchable text.
  - Improve Task-Form styling and Usability
  - Add specific icon and watermark-icons for subtasks.


- Actor [phgross, deiferni]:

  - Add Actor to handle entities collaborating with tasks.
  - Actors can be one of the following:

    - User (OGDS or Plone)
    - Inbox
    - Contact
    - NullActor


- Test Refactoring [phgross, deiferni]:

  - Replace some mock-tests with functional tests.
  - Add sql-builders.
  - Add meta-builder for test-fixtures.
  - Setup default fixture for all functional tests.


- Migration [phgross, deiferni]:

  - Add `SchemaMigration` base class for sql-database migrations.
  - Add db-migration for recent changes to `opengever.ogds.models`.
  - Add db-migration for changes to `opengever.globalindex`.


- OGDS synchronization [lgraf]:

  - LDAP util: When querying for schema, deal with servers that don't support
    listing all operational attributes (RFC 3673).
  - OGDS sync: Unify OGDS synchronization so there's a single function
    that does the sync and that can be called from anywhere.
  - OGDS sync: Add a `bin/instance sync_ogds` zopectl command that
    can be used from a cron job.

- Additional Improvements:

  - Simplify LaTex listing adapters and include base-class.
    [phgross, deiferni]

  - Remove `ClientId` viewlet.
    [phgross, deiferni]

  - Remove `GlobalindexMaintenanceView` and `OpengeverView`.
    [phgross, deiferni]

  - Improve responsive design.
    [phgross, deiferni]

  - Display user-name in personal overview title.
    [phgross, deiferni]

  - Use correct content-type when returning 'OK' responses.
    [phgross, deiferni]

  - Sort groupmembers by label for groupmembers list.
    [phgross, deiferni]

  - Add contact-service for local contacts.
    [phgross, deiferni]

  - Refactor tree portlet.

      - Performance improvements.
      - Use JavaScript tree API for building the tree.
      - Add repository favorites.
      - Add expand store for favorites.

    [jone, phgross]

  - Update DocProperties when documents are moved/pasted and checked-in/checked out.
    Create a journal entry when modifying/initializing DocProperties.
    [deiferni]

  - Display a warning message in the download confirmation overlay when no file is available.
    [deiferni]

  - Fix an issue with z3c.form inline validation.
    [deiferni]

  - Reactivate statefilter for Dossiers.
    [phgross]

  - Added option to checkin documents without comment.
    [lknoepfel, deiferni]

  - Fix missing file in initial template versions.
    [deiferni]

  - Also display `pdf-tasks-listing` and `task-report` actions for inbox task-listings.
    [deiferni]

  - Fix an issue with autocompleting assignee/issuer while creating forwardings.
    [deiferni]

  - List all users in advanced-search when searching for dossiers.
    [deiferni]

  - Added option to disable download confirmation.
    [lknoepfel]

  - Add separate profile with the gever specific mimetypes.
    This fixes the mimetype icons bug.
    [phgross]

  - Fix an issue while deactivating dossiers with already closed subdossiers.
    [deiferni]

  - Fix issue when uploading files with firefox over the Document AddForm.
    Added temporary monkeypatch to ignore mimetypes sent by the browser.
    [phgross]

  - Fix an unicode issue while syncing document filename and title.
    [deiferni]

  - Fix an issue with filtering for dossier-participants.
    [deiferni]

  - Made checkbox column not sortable, to avoid CatalogError's.
    [phgross]

  - Fixed move items functionality for moving tasks.
    [phgross]

  - Security fixes: avoid injecting javascript (XSS) using safe_html transforms.
    [phgross]


3.4.2 (2014-11-25)
------------------

- Dropped prevent_deletion handler.
  [phgross]

- Fixed mail download for mails with already CRLF.
  [phgross]

- Mail Download: Convert LF to CRLF, to avoid displaing problems in MS Outlook.
  [phgross]

- Set content-type correctly for ok_response in inter-client functionalities.
  [deiferni]

- Make reference_prefix_manager deal properly with already deleted objects.
  [phgross]

- Use `ftw.profilehook` instead of setuphandlers.
  [deiferni]


3.4.1 (2014-09-03)
------------------

- Monkey patch ftw.mail.inbound.createMailInContainer because
  `preserved_as_paper` has a schema level default, its default
  value doesn't get set correctly, so we set explicitely after setting
  the defaults.
  [lgraf]

- Mail preview tab: fixed bug in mimetype lookup for attachments with
  a wrong mimetype.
  [phgross]


3.4.0 (2014-08-28)
------------------

- General fixes:

  - Fixed translation for filing_number column in dossier listings.
    [phgross]
  - Also check for not supplied mails, when check if dossier could be resolved.
    [phgross]
  - Fixed unicode decode bug in task overview.
    [lknoepfel]
  - OGQuickUploadCapableFileFactory: Set default values before adding content to container.
    (Prevents values set by handlers on ObjectAddedEvent to be overwritten again).
    [lgraf]
  - Fix issue with `prevent_deletion` subscriber not being able to acquire membership_tool
    because of broken acquisition during Plone site deletion.
    [lgraf]
  - Customize plone.dexterity default view for all dexterity content in
    order to be able to omit specific fields, and remove previous customizations.
    [lgraf]


- Changes to document metadata:

  - Document metadata: Refactor behaviors to be a package with separate modules.
    [lgraf]
  - Monkey patch DexterityContent.__getattr__.
    This is required to support dynamic lookup of schema-level default values for
    fields in behaviors. It basically is a backport of this Dexterity 2.x fix:
    https://github.com/plone/plone.dexterity/commit/dd491480b869bbe21ee50ef413c263705af7b170
    [lgraf]
  - Refactored document overview.
    [lgraf]
  - Implement document metadata behavior for mail (incl. upgrade step and init event).
    [mathias.leimgruber]
  - Show classification infos on document overview tab.
    [mathias.leimgruber]
  - Customized document default view in order to render `file`
    field in NO_DOWNLOAD_DISPLAY_MODE.
    [lgraf]
  - Changed German wording for value `unchecked` for both public_trial and archival_value:
    "Noch nicht geprüft" -> "Nicht geprüft"
    [lgraf]
  - Change german wording for descriptions of `public_trial` and `public_trial_statement`
    [lgraf]
  - Added `regulations` and `directive` options to `document_type` vocabulary.
    [lgraf]


- Changes to journaling:

  - Fix double journal entries using quickupload.
    [mathias.leimgruber]
  - Journalize any changes to `public_trial` field.
    [lgraf]
  - Journal: Listen on IBaseDocument instead of IDocumentSchema - mails are now also
    considered documentish and should be treated equally.
    [lgraf]
  - Journalize AttachmentsDeleted event.
    [lgraf]
  - Create initial journal entry for mails.
    [lgraf]


- Changes related to mail content type:

  - Implement tabbedview for ftw.mail.mail content (Preview / Journal / Info).
    [mathias.leimgruber]
  - Use IDocumentNameFromTitle behavior from document also for mail.
    [mathias.leimgruber]
  - Use document byline also on mail.
    [mathias.leimgruber]
  - Add classification behavior to mail.
    [mathias.leimgruber]
  - Add overview tab for mail (shows some basic metadata).
    [mathias.leimgruber]
  - File a copy of the mail in the dossier by default when sending documents from GEVER.
    [lgraf]
  - Hide duplicate mail title in mail preview tab.
    [lgraf]
  - Add plone.app.lockingbehavior to ftw.mail.mail FTI.
    [lgraf]
  - Add 'Edit Metadata' action to ftw.mail.mail FTI.
    [lgraf]
  - Override ftw.mail default view with our customized dexterity default view.
    [lgraf]
  - Make FileOrPaperValidator consider mails properly (always digitally available).
    [lgraf]
  - Disable the editable border for the extract attachments view.
    [lgraf]
  - Improved wording of German translations in extract attachments view.
    [lgraf]
  - Added new mail event `AttachmentsDeleted`.
    [lgraf]
  - Mail overview: display the original message including a download link.
    [phgross]
  - Reword status message after sending documents by e-mail.
    [lgraf]
  - Use the same customized download view we use for documents for mails as well.
    [lgraf]
  - Don't encode attached mails when sending documents as email.
    [lgraf]
  - Always set `digitally_available` to `True` upon mail creation.
    [lgraf]

- Changes related to public_trial field:

  - Added limited-public option for public_trial field.
    [lknoepfel]
  - Vocabulary for public_trial is no longer a restricted vocab. It behaves like a regular one.
    [mathias.leimgruber]
  - Added public_trial index and metadata field.
    [lknoepfel]
  - Added public_trial column to document tab.
    [lknoepfel, phgross]
  - Allow public trial state to also be modified in closed dossier states.
    [mathias.leimgruber]
  - Add an IClassificationSettings registry record with `public_trial_default_value`.
    [lgraf]
  - Make default value adapter for `public_trial` use the configurable default
    value from IClassificationSettings registry record.
  - Reword German translations for public_trial_statement label and description.
    [lgraf]
  - Don't show public trial edit form for template dossiers.
    [lgraf]
  - Remove `public_trial` field from repository byline.
    [lgraf]
  - Omit `public_trial` and `public_trial_statement` fields from dossier and
    repository folder default views.
    [lgraf]
  - Disable public_trial edit_form when parents dossier is inactive.
    [phgross]
  - Added public_trial_statement field to the public_trial edit form.
    [phgross]


3.3.2 (2014-08-08)
------------------

- Fixed seralization error in responsetransporter, when changes containing date's.
  [phgross]


3.3.1 (2014-07-28)
------------------

- Made logout overlay easier to customize.
  [phgross]

- AdvancedSearch: Fixed bug which renders the wrong widget for first request.
  [phgross]

- Search type filter: limit types to main types.
  [phgross]

- Overwrite searchbox viewlet and javascript.
  So there is always a advanced search link.
  [Julian Infanger]

- Breadcrumb: Replace Home label with curent client label.
  [phgross]

- Disable edit-bar for the advancedsearch form.
  [phgross]

- Dropped no longer used attach remote document action.
  [phgross]

- Moved time column in journal tab to the far left.
  [lknoepfel]

- Fixed bug where quickupload didn't remove the active class.
  [lknoepfel]

- Renamed german version of move-items-button.
  [lknoepfel]

- Initialized opengever.sharing version. Moved prepoverlay initialization to opengever.base.
  [lknopfel]

- Added download copy in tooltip.
  [lknoepfel]

- Display document mimetype icons in ContentTreeWidget.
  [phgross]

- Use existing styles for table in tasktemplate view.
  [Julian Infanger]

- Changed default placeholder for searchbox.
  [Julian Infanger]

- Removed unused yearfolder workflow.
  [lknoepfel]

- Fixed table display in add-tasktemplate form.
  [phgross]

- Fixed widget definition for date fields in tasks edit form.
  [phgross]

- Added viewlet to colorize special pages as dev, test, ...
  [Julian Infanger]

- Fixed outdated profile versions for og.base:default and og.examplecontent:default.
  [lgraf]

- Added repository.csv to xlsx script.
  [lknoepfel]

- Changed format of examplecontent excel to xlsx.
  [lknoepfel]

- Dossierdetails: Fixed label for the Dossier end.
  [phgross]

- Added reviewer role on admin groups.
  This role ensures that admins can see the menu bar.
  [lknoepfel]

- Inbox: Removed icon from byline.
  [Julian Infanger]

- Refactored some hard to change test data.
  [lgraf]

- PDF Listings: Made repository_title getter reference formatter independent.
  [phgross]


3.3 (2014-06-05)
----------------

- Added initial implementation for setting DocProperties when creating
  a document from template.
  [lgraf]

- Fixed zipexport-enable upgrade step to match the new registry entry.
  With ftw.zipexport 1.2.0 the registry name changes which brakes our upgrade step.
  [lknoepfel]

- Added responsible org field on repositoryfolder.
  [lknoepfel]

- Treeportlet: Enable scrolling in the portlet and scroll down to selected item.
  [Julian Infanger]

- Changed source for repository import: from csv to xls.
  [lknoepfel]

- Byline: Removed icon from byline.
  [Julian Infanger]

- Fixed interface in dossiers ConstrainTypeDecider.
  [phgross]

- Updated ftw.zipexport registry entry to multi-value field.
  [lknoepfel]

- Added handling for missing document_type in document view.
  This field is hidden on a customer installation.
  [lknoepfel]

- Dossierdetails PDF: Fixed doubled encoded repository_path.
  [phgross]

- Dossierdetails PDF: Fixed UnicodeEncodeError in responsible getter.
  [phgross]

- Passing search string from live search to advanced search.
  Using SearchableText from the url as default value in advanced search.
  [lknoepfel]

- Styled document from template form.
  [lknoepfel]

- Setup: Activate navigation portlet on the templatedossier.
  [phgross]

- Allow nested Templatedossiers.
  [phgross]

- Limit query depth in templatedossier listings(documents, trash).
  [phgross]

- Treeportlet: Implement deferred tree rendering.
  [phgross]

- Fixed German translation in logout overlay.
  [pha]

3.2.4 (2014-05-26)
------------------

- Added missing french (and german) translations.
  Fixed i18n domain and translated vdex.
  [lknoepfel]

- Mail view: use sprite icons in the attachments list.
  [phgross]

- Implemented cache invalidation for TreeView portlet cache.
  [lgraf]

- Update og.mail tests according to changes in ftw.mail.
  (See https://github.com/4teamwork/ftw.mail/pull/17)

- Fixed typo in test_overview.py.
  [lknoepfel]

- Moved create repository script from opengever.zug package.
  [lknoepfel]

- Replaced ext-js function 'remove' with pure js version in advancedsearch.
  [lknoepfel]

- Fixed backref name of the groups_user join table.
  [phgross]

- Task overview: Hide client prefix in issuer value for a one client setup.
  [phgross]


3.2.3 (2014-04-01)
------------------

- Hide standard ftw.mail mail-in viewlet (we display the mail address in
  the byline).
  [lgraf]

- Removed og.mail IMailSettings registry interface (now done in ftw.mail).
  Added upgrade step to migrate settings to ftw.mail's IMailSettings and
  remove old og.mail IMailSettings.
  [lgraf]

- Provide an IntIdResolver adpater to generate Dossier Mail-In addresses
  based on IntIds, and use it instead of the old implementation.
  [lgraf]

- Removed IMailInAddress behavior. Not needed any more with ftw.mail 2.0.
  [lgraf]

- Replaced hardcoded workflow names with constants.
  [lknoepfel]

- Updated move destination widget to hide closed dossiers.
  [lknoepfel]

- Added french translation by I. Anthenien.
  [lknoepfel]

- ldap_util: Make check for user object classes case-insensitive.
  [lgraf]

- Added french translation by I. Anthenien.
  [lknoepfel]


3.2.2 (2014-03-11)
------------------

- Don't hard code reference formatter in tabbed view custom sorter. Look it up
  from IReferenceNumberSettings instead.
  [lgraf]

- Fixed missing role and available expression in reference prefix manager.
  [lknoepfel]

- Added NoClientIdDotted reference number formatter.
  [lknoepfel]

- Personal Overview: Raise Unauthorized for unauthenticated users instead of
  hardcoded redirect to login form.
  This is required for Single-Sign-On with SPNEGO plugin to work.
  [lgraf]

- Use always logged in user as responsible of a subdossier.
  [lknoepfel]

- Remove obsolete dependency on transmogrify.sqlinserter.
  [lgraf]


3.2.1 (2014-01-23)
------------------

- Implement custom sort functions for both 'dotted' and 'grouped_by_three'
  reference formatters.
  [lgraf]

- Add requirement for a custom sort function to IReferenceFormatter interface
  [lgraf]

- Remove 4teamwork-ldap/ldap_plugin.xml from .gitignore and check it in
  (with placeholder credentials).
  [lgraf]

- Configure LDAP credentials from JSON file.
  [lgraf]

- Fix raising of exceptions and logging in msg2mime transform.
  [lgraf]

3.2 (2013-12-15)
----------------

- Increase task_principals.principal column length to 255.
  [lgraf]

- Logout overlay: use absolute url to redirect to the logout view.
  [phgross]

- Add destructive class to logout button in logout overlay.
  [Julian Infanger]

- Add specific byline for the PloneSite(Personal overview).
  [phgross]

- Adjusted seperator of the `grouped_by_three` formatter.
  [phgross]

- Corrected message after resolving a subdossier.
  [phgross]

- Override livesearch_reply.py to provide correct advanced search link.
  [lgraf]

- Hide paste action for template dossier and contact folder.
  [lgraf]

- Activate selction controlls for the `my documents` Tab.
  [phgross]

- Advancedsearch: Dropped reference number solution.
  [phgross]

- OGDS Listing: Display empty string for users without a name or firstname.
  [phgross]

- OGDS updater: Make check for AD user IDs more robust.
  [lgraf]

- DefaultDocumentIndexer: Store transform cache on context.file._blob, not context.file.
  (NamedFileInstances are not recreated when updating file contents)
  [lgraf]

- LDAP util: Make sure we still deal with multivaluedness for non-user
  objects (fix for bug introduced in 1daa9ba).
  [lgraf]

- LDAP import: Deal with Active Directory nested groups.
  [lgraf]

- OGDS updater: Consider all possible member attribute names when getting members from a group.
  [lgraf]

- LDAP util: Consider all possible objectClasses when searching for groups.
  [lgraf]

- LDAP util: Only apply schema mapping to user objects.
  [lgraf]

- DefaultDocumentIndexer: Catch any exceptions raised by transforms and log them.
  [lgraf]

- OGDS updater: Deactivate is_ldap_reachable check. It's unnecessary and broken.
  [lgraf]

- Modify indexer for documents so that it queries for our own IDocumentIndexer adapter,
  allowing us to choose to index original documents or their preview PDF, depdending on
  opengever.pdfconverter being installed or not.
  [lgraf]

- OGDS updater: fullname field is already single-valued, don't try to treat it like a list.
  [lgraf]

- Moved docucomposer in own package.
  [lknoepfel]

- LDAP util: Only use PagedResults controls if the server advertises to support them.
  [lgraf]

- LDAP util: When checking if attributes are multivalued, store results in a cache.
  This prevents us from hitting the schema more often than necessary, and, as a side
  effect, causes warnings about attributes not declared in schemata to be printed
  only once.
  [lgraf]

- LDAP util: Added method to list all objectClasses defined in schema.
  [lgraf]

- LDAP import: groupid may be in 'cn' or 'fullname' attribute.
  Handle both cases gracefully.
  [lgraf]

- Updated i18n-build with the option to build only one subpackage.
  [lknoepfel]

- Fixed unicode encoding bug in search for autocomplete of ContactsVocabulary.
  [lknoepfel]

- Disabled illogical actions in template dossier.
  [lknoepfel]

- Restricted reference prefix manager to repository and repositoryroot.
  [lknoepfel]


3.1.4 (2014-02-18)
------------------

- Removed DocuComposer actions from opengever.dossier:default profile.
  [lgraf]


3.1.3 (2014-02-06)
------------------

- Remove remaining traces of `related_items` index.
  Backport of 9d1064d.
  [lgraf]

- Dossier resolving: Fixed `its_all_closed` check, for nested subtasks.
  [phgross]

- Document tooltip helper: Fixed link for the icon.
  [phgross]

- Fixed load order issue when setting tagged values to omit the changeNote
  field from the IVersionable behavior.
  Backport of d8438c8.
  [lgraf]

- OGDS Updater: Gracefully skip users outside users_base referenced in groups.
  Backport of 2d862bd.
  [lgraf]

- Removed related_items index and RelatedTasks tab.
  [lknoepfel]


3.1.2 (2013-12-02)
------------------

- Issued inbox task: fixed listing query, to search the complete client.
  [phgross]

- Inbox overview: List only active tasks and forwardings.
  [phgross]

- Inbox overview: Only list current part of a predecessor/successor couple.
  [phgross]


3.1.1 (2013-10-23)
------------------

- Fixed CleanupReferencePrefixMapping upgradestep
  (works now for reference to no longer existing objects):
  [phgross]


3.1 (2013-10-23)
----------------

- Update reference prefix manager to the new version of adapters.
  [lknoepfel]

- Fixed client setup: use system user instead of hardcoded username.
  [lknoepfel]

- Fixed redirect when creating a subtask.
  [phgross]

- Integrate ftw.zipexport.
  [lknoepfel]

- Reworked forwarding refuse and reassign functionality.
  [phgross]

- Reworked inbox tabs.
  [phgross]

- Activate reporting actions (dossier and tasks) for every user.
  [phgross]

- Dossiercover: Implements breadcrumb cropping and adjust fonz size.
  [phgross]

- Dropped inbox_group agency for tasks in a oneclient setup.
  [phgross]

- Task workflow: Documents inside a task, aren't editable when the dossier is closed.
  [phgross]

- Reworked document_author resolution and displaying value in listings.
  [phgross]

- Fixed permissions problems when copying dossiers.
  [lgraf]

- LDAP import: Use the respective property from LDAPUserFolder to determine which is the
  UID attribute.
  [lgraf]

- LDAP util: Make determining multi-valuedness of attributes more robust
  in case of broken LDAP schemas.
  [lgraf]

- LDAP util: Get user object classes from LDAPUserFolder instead of hardcoding them.
  [lgraf]

- Added modify deadline form and functionality.
  [phgross]

- Removed client prefixes in single client setups.
  [lknoepfel]

- Use ftw.builder instead of our own builder implementation.
  [phgross]


3.0.1 (2013-10-21)
------------------

- LDAP import: If server doesn't support page controls, fall back to issuing
  search request without them.
  [lgraf]


3.0 (2013-08-14)
----------------

- Make exposator work for both izug.basetheme and plonetheme.teamraum.
  [Julian Infanger]

- Fixed imports in the processInputs monkeypatch.
  [phgross]

- Dossier overview: only list active subdossiers.
  [phgross]

- Rewrote LDAP synchronisation in pure Python instead of Transmogrifier.
  [lgraf]

- Removed development LDAP configuration for now.
  [lgraf]

- Fix import of HAVE_BLOBS from plone.namedfile.
  [lgraf]

- Repository Setup: Moved config and blueprints from zugpolicy.base in to core.
  [phgross]

- Dossier: Fixed start- and end-date validation in edit forms.
  [phgross]

- Task: Adjust workflow, so that documents inside a task, aren't editable
  when the dossier is closed.
  [phgross]

- AdvancedSearch: Added special description for the portal types field
  in a multiclientsetup.
  [phgross]

- Added filter_pattern option to LDAPSource blueprint.
  If set, only imports users whose email address match `filter_pattern`.
  [lgraf]

- Rebuild OpengeverContentListing registration.
  Use additional interface instead of overrides.zcml
  [phgross]

- Monkey patch plone.dexterity.content.Container.__ac_permissions__ in order
  to declare sane permissions for manage_pasteObjects.
  [lgraf]

- Added bin/build-translations script to opengever.core buildout.
  [lgraf]

- Added bin/i18n-build script to opengever.core buildout.
  [lgraf]

- Made sure PDF Preview link in doc tooltip is only displayed when
  PDF preview rendering is available.
  [lgraf]

- Lay out date range fields in advanced search form side by side.
  Note: This requires the "Init og.advancedsearch profile version" upgrade
  step from opengever.base to be run first!
  [lgraf]

- Removed description texts for advanced search dossier date range fields.
  This is being done in order to avoid layouting issues.

- Extract attachments: Set digitially_available allways to true.
  [phgross]
