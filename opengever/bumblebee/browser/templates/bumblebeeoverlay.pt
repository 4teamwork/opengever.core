<aside class="sidebar"
       i18n:domain="opengever.bumblebee"
       tal:define="file_size view/overlay/get_file_size">
  <header>
    <span tal:attributes="class string:file-mimetype ${view/overlay/get_mime_type_css_class}" />
    <div>
      <a class="title"
         tal:attributes="href context/absolute_url"
         tal:content="view/overlay/get_title" />
      <span class="filesize" tal:condition="file_size" tal:content="string:${file_size} KB" />
    </div>
  </header>
  <main>
    <table class="metadata">
      <tr>
        <td class="title" i18n:translate="">Creator:</td>
        <td class="value" tal:content="structure view/overlay/get_creator_link"></td>
      </tr>
      <tr tal:define="date view/overlay/get_document_date" tal:condition="nocall: date">
        <td class="title" i18n:translate="">Document date:</td>
        <td class="value" tal:content="date"></td>
      </tr>
      <tr tal:define="dossier view/overlay/get_containing_dossier" tal:condition="nocall: dossier">
        <td class="title" i18n:translate="">Dossier:</td>
        <td class="value">
          <a tal:attributes="href dossier/absolute_url" tal:content="dossier/Title" />
        </td>
      </tr>
      <tr>
        <td class="title" i18n:translate="">Reference number:</td>
        <td class="value" tal:content="view/overlay/get_reference_number"></td>
      </tr>
    </table>
  </main>
  <footer>
    <ul class="file-actions" i18n:domain="opengever.document">
      <li tal:define="link view/overlay/get_checkout_url" tal:condition="nocall: link">
       <tal:cond tal:condition="context/@@officeconnector_settings/is_checkout_enabled">
         <a tal:attributes="href string:javascript:officeConnectorCheckout('${context/absolute_url}/officeconnector_checkout_url');;"
             class="function-edit"
             href="#"
             i18n:translate="label_checkout_and_edit">
             Checkout and edit
         </a>
       </tal:cond>
       <tal:cond tal:condition="not: context/@@officeconnector_settings/is_checkout_enabled">
         <a tal:attributes="href link"
             class="function-edit"
             i18n:translate="label_checkout_and_edit">
             Checkout and edit
          </a>
       </tal:cond>
      </li>
       <tal:cond tal:condition="context/@@officeconnector_settings/is_attach_enabled">
        <li>
         <a tal:attributes="href string:javascript:officeConnectorAttach('${context/absolute_url}/officeconnector_attach_url');;"
             class="function-attach"
             href="#"
             i18n:translate="label_attach_to_email">
             Attach to email
         </a>
        </li>
       </tal:cond>
      <li tal:define="link view/overlay/get_checkin_without_comment_url" tal:condition="nocall: link">
        <a id="action-checkin"
            tal:attributes="href link"
            i18n:translate="">
            Checkin without comment
         </a>
      </li>
      <li tal:define="link view/overlay/get_checkin_with_comment_url" tal:condition="nocall: link">
        <a id="action-checkin"
            tal:attributes="href link"
            i18n:translate="">
            Checkin with comment
         </a>
      </li>
      <li id="action-revert"
          tal:define="link view/overlay/get_revert_link"
          tal:condition="nocall: link"
          tal:content="structure link">
      </li>
      <li tal:define="link view/overlay/get_edit_metadata_url" tal:condition="nocall: link">
        <a id="action-edit"
            tal:attributes="href link"
            i18n:domain="plone"
            i18n:translate="">
            Edit metadata
         </a>
      </li>
      <li tal:define="link view/overlay/get_download_copy_link"
          tal:condition="nocall: link"
          tal:content="structure link">
      </li>
      <li tal:define="link view/overlay/get_open_as_pdf_url" tal:condition="nocall: link">
        <a tal:define="target python: '_blank' if view.overlay.should_open_in_new_window() else None"
            id="action-pdf"
            tal:attributes="href link; target target | nothing;"
            i18n:domain="opengever.bumblebee"
            i18n:translate="label_open_document_as_pdf">
            Open as PDF
        </a>
      </li>
      <li tal:define="link view/overlay/get_detail_view_url" tal:condition="python:not view.on_detail_view and link">
        <a id="action-view"
            tal:attributes="href link"
            i18n:domain="opengever.bumblebee"
            i18n:translate="label_open_detail_view">Open detail view</a>
      </li>
    </ul>
    <div class="info-viewlets">
      <div tal:replace="structure view/overlay/render_checked_out_viewlet" />
      <div tal:replace="structure view/overlay/render_lock_info_viewlet" />
      <div tal:condition="view/overlay/is_versioned_context">
        <dl class="portalMessage warning">
          <dt i18n:domain="plone" i18n:translate="">Warning</dt>
          <dd i18n:translate="warning_on_versioned_context">
            You are looking at a versioned file.
          </dd>
        </dl>
      </div>
    </div>
  </footer>
</aside>
<article id="file-preview"
         tal:define="pdf_url view/overlay/get_preview_pdf_url;
                     has_file view/overlay/has_file">
  <iframe tal:condition="has_file" tal:attributes="src pdf_url" />
  <img class="bumblebee-thumbnail" tal:condition="not:has_file" tal:attributes="src pdf_url" />
</article>
