Dossier Browser Test

import:
    >>> from plone.app.testing.interfaces import SITE_OWNER_NAME, SITE_OWNER_PASSWORD
    >>> from plone.testing.z2 import Browser
    >>> from datetime import datetime, timedelta

browser configuration:
	>>> app = layer['app']
	>>> portal = layer['portal']
    >>> browser = Browser(app)
    >>> portal_url = portal.absolute_url()

login:
    >>> browser.open('%s/login_form' % portal_url)
    >>> browser.getControl(name='__ac_name').value = SITE_OWNER_NAME
    >>> browser.getControl(name='__ac_password').value = SITE_OWNER_PASSWORD
    >>> browser.getControl(name='submit').click()

check dossier add form:

    >>> browser.open('%s/++add++opengever.dossier.businesscasedossier' % portal_url)
    >>> 'Add Business Case Dossier' in browser.contents
    True

default values (responsible, start)

	# not possible to test because the name of the control comes from javascript.
    # >>> browser.getControl(name='form.widgets.IDossier.responsible:list').value
    # ['SITE_OWNER_NAME']

    >>> ' %i,' % datetime.now().day in browser.getControl(name='form.widgets.IDossier.start').value
    True

check variants

    >>> browser.getControl(name='form.widgets.IOpenGeverBase.title').value = 'Dossier Test'
    >>> yesterday = datetime.now() - timedelta(days=3)
    >>> browser.getControl(name='form.widgets.IDossier.end').value = yesterday.strftime('%B %d, %Y')
    >>> browser.getControl(name='form.buttons.save').click()
    >>> browser.url == '%s/++add++opengever.dossier.businesscasedossier' % portal_url
    True

create dossier and edit

    >>> browser.getControl(name='form.widgets.IDossier.end').value = ''

    >>> browser.getControl(name='form.buttons.save').click()
    >>> browser.url
    'http://nohost/plone/dossier-3/tabbed_view'

check the label
    >>> browser.open('http://nohost/plone/dossier-3/edit')
    >>> 'Edit Business Case Dossier' in browser.contents
    True

and the default value
    >>> browser.getControl(name='form.widgets.IDossier.responsible:list').value
    ['admin']

create and edit subdossier
    >>> browser.open('http://nohost/plone/dossier-3/++add++opengever.dossier.businesscasedossier')
    >>> 'Add Subdossier' in browser.contents
    True
    >>> browser.getControl(name='form.widgets.IOpenGeverBase.title').value = 'Dossier Test'
    >>> browser.getControl(name='form.buttons.save').click()
    >>> browser.url
    'http://nohost/plone/dossier-3/dossier-4/tabbed_view'

    >>> browser.open('http://nohost/plone/dossier-3/dossier-4/edit')
    >>> 'Edit Subdossier' in browser.contents
    True
    >>> browser.getControl(name='form.buttons.cancel').click()

