<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"
      lang="en"
      i18n:domain="opengever.meeting">

    <metal:content-core fill-slot="content-core">
      <metal:content-core define-macro="content-core"
                          tal:define="meeting view/model;
                                      agenda_items python: list(view.get_agenda_items(include_paragraphs=True));">
        <div id="opengever_meeting_protocol">
          <metal:use use-macro="context/@@ploneform-macros/titlelessform">

            <metal:block fill-slot="fields">
             <div class="agenda_items">
                <label id="dummy"></label>
                <metal:block tal:repeat="protocol agenda_items">
                  <metal:block tal:define="name protocol/name">

                    <h2 tal:attributes="id name;
                                        class python: 'protocol_title ' + protocol.get_css_class()">
                      <span class="title" tal:content="python: protocol.get_title(include_number=True)"></span>
                      <span class="dossier_reference_number" tal:content="protocol/get_dossier_reference_number"></span>
                    </h2>

                    <metal:block tal:condition="not: protocol/is_paragraph">

                      <metal:block tal:condition="protocol/has_proposal">
                          <label tal:attributes="for string:${name}-legal_basis;
                                                 id string:${name}-legal_basis-label"
                                 i18n:translate="label_legal_basis">
                                 Legal basis
                          </label>
                          <textarea class="textarea-widget text-field"
                                    tal:attributes="name string:${name}.legal_basis:record;
                                                    id string:${name}-legal_basis"
                                    tal:content="protocol/legal_basis"/>

                          <label tal:attributes="for string:${name}-initial_position;
                                                 id string:${name}-initial_position-label"
                                 i18n:translate="label_initial_position">
                                 Initial position
                          </label>
                          <textarea class="textarea-widget text-field"
                                    tal:attributes="name string:${name}.initial_position:record;
                                                    id string:${name}-initial_position"
                                    tal:content="protocol/initial_position"/>

                          <label tal:attributes="for string:${name}-proposed_action;
                                                 id string:${name}-proposed_action-label"
                                 i18n:translate="label_proposed_action">
                                 Proposed action
                          </label>
                          <textarea class="textarea-widget text-field"
                                    tal:attributes="name string:${name}.proposed_action:record;
                                                    id string:${name}-proposed_action"
                                    tal:content="protocol/proposed_action"/>

                          <label tal:attributes="for string:${name}-considerations;
                                                 id string:${name}-considerations-label"
                                 i18n:translate="label_considerations">
                                 Considerations
                          </label>
                          <textarea class="textarea-widget text-field"
                                    tal:attributes="name string:${name}.considerations:record;
                                                    id string:${name}-considerations"
                                    tal:content="protocol/considerations"/>
                      </metal:block>

                      <label tal:attributes="for string:${name}-discussion;
                                             id string:${name}-discussion-label"
                             i18n:translate="label_discussion">
                             Discussion
                      </label>
                      <textarea class="textarea-widget text-field"
                                tal:attributes="name string:${name}.discussion:record;
                                                id string:${name}-discussion"
                                tal:content="protocol/discussion"/>

                      <label tal:attributes="for string:${name}-decision;
                                             id string:${name}-decision-label"
                             i18n:translate="label_decision">
                             Decision
                      </label>
                      <textarea class="textarea-widget text-field"
                                tal:attributes="name string:${name}.decision:record;
                                                id string:${name}-decision"
                                tal:content="protocol/decision"/>

                      <label tal:attributes="for string:${name}-publish_in;
                                             id string:${name}-publish_in-label"
                             i18n:translate="label_publish_in">
                             Publish in
                      </label>
                      <textarea class="textarea-widget text-field"
                                tal:attributes="name string:${name}.publish_in:record;
                                                id string:${name}-publish_in"
                                tal:content="protocol/publish_in"/>

                      <label tal:attributes="for string:${name}-disclose_to;
                                             id string:${name}-disclose_to-label"
                             i18n:translate="label_disclose_to">
                             Disclose to
                      </label>
                      <textarea class="textarea-widget text-field"
                                tal:attributes="name string:${name}.disclose_to:record;
                                                id string:${name}-disclose_to"
                                tal:content="protocol/disclose_to"/>

                      <label tal:attributes="for string:${name}-copy_for_attention;
                                             id string:${name}-copy_for_attention-label"
                             i18n:translate="label_copy_for_attention">
                             Copy for attention
                      </label>
                      <textarea class="textarea-widget text-field"
                                tal:attributes="name string:${name}.copy_for_attention:record;
                                                id string:${name}-copy_for_attention"
                                tal:content="protocol/copy_for_attention"/>

                    </metal:block>
                  </metal:block>
                </metal:block>

                <metal:use use-macro="context/@@meeting-macros/disable_kss_inline_validation" />
              </div>
            </metal:block>

            <metal:block fill-slot="actions">
              <div class="metadata">
                <div class="fields">
                  <metal:use use-macro="context/@@ploneform-macros/fields" />
                  <metal:use use-macro="context/@@ploneform-macros/actions" />
                </div>
              </div>
              <div class="protocol-navigation" id="protocol-navigation">
                <ul id="scrollspy" class="nav">
                    <li tal:repeat="protocol agenda_items"
                        tal:attributes="class python: 'expandable ' + protocol.get_css_class()">
                      <metal:block tal:define="name protocol/name">
                        <a tal:attributes="href string:#${name};
                                           id string:${name}-anchor;
                                           class python: 'expandable ' + protocol.get_css_class()"
                           tal:content="python: protocol.get_title(include_number=True)">
                        </a>
                          <metal:block tal:condition="not: protocol/is_paragraph">
                            <ul class="nav">
                              <metal:block tal:condition="protocol/has_proposal">
                                <li>
                                  <a tal:attributes="href string:#${name}-legal_basis;
                                                     id string:${name}-legal_basis-anchor"
                                     i18n:translate="">
                                     Legal basis
                                   </a>
                                </li>
                                <li>
                                  <a tal:attributes="href string:#${name}-initial_position;
                                                     id string:${name}-initial_position-anchor"
                                     i18n:translate="label_initial_position">
                                     Initial position
                                   </a>
                                </li>
                                <li>
                                  <a tal:attributes="href string:#${name}-proposed_action;
                                                     id string:${name}-proposed_action-anchor"
                                     i18n:translate="label_proposed_action">
                                     Proposed action
                                   </a>
                                </li>
                                <li>
                                  <a tal:attributes="href string:#${name}-considerations;
                                                     id string:${name}-considerations-anchor"
                                     i18n:translate="label_considerations">
                                     Considerations
                                   </a>
                                </li>
                              </metal:block>
                              <li>
                                <a tal:attributes="href string:#${name}-discussion;
                                                     id string:${name}-discussion-anchor"
                                   i18n:translate="label_discussion">
                                   Discussion
                                 </a>
                              </li>
                              <li>
                                <a tal:attributes="href string:#${name}-decision;
                                                     id string:${name}-decision-anchor"
                                   i18n:translate="label_decision">
                                   Decision
                                 </a>
                              </li>
                              <li>
                                <a tal:attributes="href string:#${name}-publish_in;
                                                     id string:${name}-publish_in-anchor"
                                   i18n:translate="label_publish_in">
                                   Publish in
                                 </a>
                              </li>
                              <li>
                                <a tal:attributes="href string:#${name}-disclose_to;
                                                     id string:${name}-disclose_to-anchor"
                                   i18n:translate="label_disclose_to">
                                   Disclose to
                                 </a>
                              </li>
                              <li>
                                <a tal:attributes="href string:#${name}-copy_for_attention;
                                                     id string:${name}-copy_for_attention-anchor"
                                   i18n:translate="label_copy_for_attention">
                                   Copy for attention
                                 </a>
                              </li>
                            </ul>
                          </metal:block>
                        </metal:block>
                    </li>
                </ul>
              </div>
            </metal:block>

          </metal:use>
      </metal:content-core>
    </metal:content-core>

</html>
