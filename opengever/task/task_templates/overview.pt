<table class="listing task-listing">
    <tal:rep tal:define="group python: view.groups[0]">

        <tr>
            <span tal:condition="python: group.widgets['text']" />
            <th tal:content="python: group.widgets['text'].label" />
            <td tal:content="structure python: group.widgets['text'].render()" />
        </tr>

        <tr tal:condition="python: 'task_type' in group.widgets">
            <th tal:content="python: group.widgets['task_type'].label" />
            <td tal:content="structure python: group.widgets['task_type'].render()" />
        </tr>

        <tr>
            <th i18n:domain="opengever.task" i18n:translate="label_workflow_state">State</th>
            <td i18n:translate="" i18n:domain="plone" tal:content="python: view.context.portal_workflow.getInfoFor(view.context, 'review_state')" />
        </tr>

        <tr>
            <th tal:content="python: group.widgets['issuer'].label"></th>
            <td tal:content="structure view/issuer_link" />
        </tr>

        <tr>
            <th i18n:translate="label_responsible">Responsible</th>
            <td tal:content="structure view/responsible_link" />
        </tr>

        <tr tal:condition="context/deadline">
            <th tal:content="python:group.widgets['deadline'].label"></th>
            <td tal:content="python:context.deadline.strftime('%d.%m.%Y')"/>
        </tr>

        <tr>
            <th i18n:domain="opengever.task" i18n:translate="label_last_modified">Last change</th>
            <td tal:content="python: view.context.modified().strftime('%d.%m.%Y %H:%M')"/>
        </tr>

    </tal:rep>


    <tal:rep2 tal:define="group2 python: len(view.groups) > 1 and view.groups[1] or None"
              tal:condition="python: len(view.groups) > 1">
        <tr tal:condition="python: context.expectedStartOfWork">
            <th tal:content="python: group2.widgets['expectedStartOfWork'].label"></th>
            <td tal:content="python:context.expectedStartOfWork.strftime('%d.%m.%Y')"/>
        </tr>

        <tr tal:repeat="widget group2/widgets/values">
            <tal:block condition="python:widget.__name__ not in ('IBasic.title', 'IBasic.description', 'title',
                                  'description', 'ITransition.transition', 'expectedStartOfWork', 'date_of_completion') and widget.value and widget.value != ('', '', '')">
                <th tal:content="structure widget/label" />
                <td tal:content="structure widget/render" />
            </tal:block>
            <tal:block condition="python: widget.__name__=='date_of_completion' and widget.value">
                <th tal:content="structure widget/label" />
                <td tal:content="python: context.date_of_completion.strftime('%d.%m.%Y')" />
            </tal:block>
        </tr>

    </tal:rep2>

</table>
