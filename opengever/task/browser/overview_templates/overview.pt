<html xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      tal:omit-tag="python: True">

    <tal:i18n i18n:domain="opengever.task" tal:define="groups view/boxes; css_width python:99/len(groups)">
  <div tal:repeat="boxes groups" tal:attributes="class string:boxGroup boxGroup${repeat/boxes/index}; style string:width:${css_width}%">
    <div tal:repeat="box boxes" class="box" tal:attributes="id string:${box/id}Box">
	
	
      <h2 i18n:translate=""
		tal:condition="box/content" tal:content="box/label|box/id"></h2>

      <tal:box tal:condition="python: not hasattr(box.get('content'), '__iter__')">
        <tal:item  tal:condition="box/content">
          <span tal:content="box/content" />
        </tal:item>
        <tal:item tal:condition="not: box/content">
          <span i18n:translate="no_content" />
        </tal:item>
      </tal:box>

      <tal:box tal:condition="python: hasattr(box.get('content'), '__iter__')">
        <tal:items define="items box/content">
          <ul tal:condition="items">
            <li tal:repeat="item items">

              <!-- item is a widget (used for the addition box) -->
              <tal:brain tal:condition="python: view.get_type(item) == 'widget'">
                <tal:cond tal:condition="item/label">
                  <span tal:content="structure item/label" />
                  <span>: </span>
                  <span tal:attributes="class item/css_class|nothing" tal:content="structure item/render" />
                </tal:cond>
                <tal:cond tal:condition="not: item/label">
                  <span tal:content="structure item/render" />
                </tal:cond>
              </tal:brain>

              <!-- item is a brain -->
              <tal:brain tal:condition="python: view.get_type(item) == 'brain'">
				<span tal:attributes="class python:'wf-%s' % getattr(item, 'review_state')">
                <a href="" tal:attributes="href item/getURL|nothing;
                                           title item/alt|nothing;
                                           class python:view.get_css_class(item)" tal:omit-tag="not: item/getURL|nothing">
                <span tal:content="item/Title" /></a>
				</span>
              </tal:brain>

              <!-- item is a obj -->
              <tal:brain tal:condition="python: view.get_type(item) == 'obj'">
				<span tal:attributes="class python: view.get_review_state_css(item)" tal:omit-tag="not: python:view.get_review_state_css(item)">
                <a href="" tal:attributes="href item/absolute_url|nothing;
                                           title item/Description|nothing;
                                           class python:view.get_css_class(item, is_brain=False)" tal:omit-tag="not: item/absolute_url|nothing">
                <span tal:content="item/Title" /></a>
				</span>
              </tal:brain>

              <!-- item is a dict (Documents and participants) -->
              <tal:dict tal:condition="python: view.get_type(item) == 'dict'">
                <a href=""
                   tal:attributes="href item/getURL|nothing;
                                   title item/alt|nothing;
                                   class python:item.get('css_class')"
                   tal:omit-tag="not: item/getURL|nothing">

                	<span tal:condition="item/getURL|nothing" tal:content="item/Title" />
                	<span tal:condition="not: item/getURL|nothing"
						  tal:content="item/Title"
						  tal:attributes="class python:item.get('css_class')" />

			   </a>
              </tal:dict>

              <!-- SQLAlchemy Objects (Tasks from GlobalIndex)-->
              <tal:sql tal:condition="python: view.get_type(item) == 'sqlalchemy_object'">
				<span tal:attributes="class python:'wf-%s' % item.review_state">
                <div tal:replace="structure python:view.render_indexed_task(item, False)" />
				</span>
              </tal:sql>
            </li>
          </ul>
          <span tal:condition="not: items" i18n:translate="no_content" />
        </tal:items>
      </tal:box>

    </div>
  </div>
  <div class="visualClear"><!----></div>
  <div tal:replace="structure provider:opengever.task.beneathTask" />
  <div class="visualClear"><!----></div>
  <div tal:replace="structure provider:plone.belowcontentbody" />
  <div class="visualClear"><!----></div>
 </tal:i18n>

</html>
